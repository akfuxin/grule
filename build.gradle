repositories {
    mavenLocal()
    maven {
        url 'http://maven.aliyun.com/nexus/content/groups/public/'
    }
    mavenCentral()

    jcenter()
}

version = '0.0.1'

apply plugin: 'java'
//apply plugin: 'distribution'

sourceCompatibility = 1.8
targetCompatibility = 1.8

dependencies {
    compile fileTree(dir: 'lib', include: ['*.jar'])
    // compile 'org.codehaus.groovy:groovy:2.5.6'
    compile 'org.codehaus.groovy:groovy:3.0.0-beta-3'
    compile 'com.alibaba:fastjson:1.2.61'
    compile 'ch.qos.logback:logback-classic:1.2.3'

    // compile ('org.codehaus.groovy:groovy-sql:2.5.6')
    // compile ('org.codehaus.groovy:groovysh:2.5.6')
    // compile ('org.codehaus.groovy:groovy-jmx:2.5.6')
    // compile 'org.codehaus.groovy:groovy-templates:2.5.6'
    compile ('cn.xnatural.enet:enet-event:0.0.11')
//    compile ('cn.xnatural.enet:enet-core:0.0.11') {
//        exclude group: 'org.codehaus.groovy'
//    }
//    compile ('cn.xnatural.enet:enet-server:0.0.11') {
//        // exclude group: 'org.jboss.resteasy', module: 'resteasy-multipart-provider'
//        // exclude group: 'org.jboss.resteasy', module: 'resteasy-netty4'
//        exclude group: 'org.jboss.resteasy'
//        exclude group: 'io.swagger.core.v3'
//    }

    compile 'org.hibernate:hibernate-core:5.4.1.Final'
    // compile 'com.alibaba:druid:1.1.12'
    compile 'com.zaxxer:HikariCP:3.4.1'
    // compile 'mysql:mysql-connector-java:5.1.34'
    compile 'com.h2database:h2:1.4.199'

    compile 'io.netty:netty-all:4.1.41.Final'
    // compile 'io.undertow:undertow-core:2.0.23.Final'
//    compile ('io.undertow:undertow-websockets-jsr:2.0.23.Final') {
//        exclude group: 'io.undertow', module: 'undertow-servlet'
//    }

    // compile 'io.netty:netty-all:4.1.32.Final'
    compile 'com.squareup.okhttp3:okhttp:3.14.2'
    compile ('org.ehcache:ehcache:3.6.3') {
        exclude group:'org.slf4j'
    }
    compile ('org.quartz-scheduler:quartz:2.3.0') {
        exclude group:'org.slf4j'
        exclude group:'com.mchange'
        exclude group:'com.zaxxer'
    }

    compile ('io.ratpack:ratpack-core:1.7.3') {
        exclude group: 'io.netty'
        // exclude group: 'com.fasterxml.jackson.core'
        exclude group: 'io.ratpack', module: 'ratpack-guice'
    }
//    compile ('io.ratpack:ratpack-groovy:1.7.3') {
//        exclude group: 'org.codehaus.groovy'
//        exclude group: 'io.netty'
//        exclude group: 'com.fasterxml.jackson.core'
//        exclude group: 'io.ratpack', module: 'ratpack-guice'
//    }
    // compile 'io.ratpack:ratpack-session:1.7.3'
    // compile 'io.ratpack:ratpack-session-redis:1.7.3'
}


// task 用来复制启动所依赖的jar包
task copyDep(type: Copy) {
    from configurations.runtime
    // from 'lib'
    into 'build/tar/lib'
}

task copyBin(type: Copy) {
    from 'bin/'
    into 'build/tar/bin'
    fileMode 0744
}

task copyConf(type: Copy) {
    from 'conf/'
    into 'build/tar/conf'
}

task copySrc(type: Copy) {
    from 'src/main/groovy'
    from 'src/main/resources'
    into 'build/tar/src'
}

task copyOther(type: Copy) {
    from 'start.sh'
    from 'start.bat'
    from '*.properties'
    into 'build/tar/'
}


task tar(dependsOn: ['copyDep', 'copyBin', 'copyConf', 'copySrc', 'copyOther'], type: Tar) {
    from "${buildDir}/tar"
    archiveName = "gy.tar"
    destinationDir = file("${buildDir}")
}

